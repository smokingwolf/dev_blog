<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>片道勇者2開発+8　射撃が通る壁＆バグ修正祭り</title>
<script>
function toggle(id){
 var e=document.getElementById(id);
 if(e.style.display==='none'){e.style.display='block';}else{e.style.display='none';}
}
</script>
</head>
<body>
<h1>片道勇者2開発+8　射撃が通る壁＆バグ修正祭り</h1>
<div>2023-08-05 10:30:22</div>
<div>ただいま<a href="https://www.silversecond.com/WolfRPGEditor/Contest/" class="red"><strong>第15回ウディコン</strong></a>中ですが元気なときは自分の開発を進めています！
疲れたときはウディコン作品を遊ばせていただいております。

そして『片道勇者』は2012/8/5公開なので実は今日で<B><span style="font-size: 200%">11周年</span></B>！
まだ遊んでくださっている皆さま、本当にありがとうございます！

今回はほとんど『片道勇者』と『片道勇者2（開発中）』のバグ修正ばっかりでした。
記事には載せてませんがウディタの修正も行っています！
こうやって思い返すと思ったより色々やってましたがもっと前進したい！

<hr size="1" />
<strong><span style="font-size:large;">【片道勇者2新機能　射撃が通る壁『柵』】</span></strong>

今回の『片道勇者2』開発は95％バグ修正週でしたが、
見た目に全く変化がないと心が苦しいので新機能を1つ搭載しました！

それが『射撃だけ通る壁』！　通称「柵」です。
<img src="../image/2023/20230805.jpg" border="1">

射撃だけ通る壁であるこの「柵」、文字通り「射撃は通る」けど
「キャラクターは通れない」し「近接攻撃も柵に当たる」という特性のもので、
柵があれば一方的に射撃で攻撃できます。

もちろん普通の壁と違って敵からも見えているので、
必要なら敵は「柵」を殴ってますし、遠距離攻撃なら
お互い何もないも同然なので撃ち合いになります。


今のところは『折りたたみ柵』というアイテムで
「柵」を設置できるようにする予定ですが、
「狩人」などのスキルとして「柵」を設置できるのも面白そうです。

近接攻撃してくる敵なら（柵が壊れるまでは）妨害し続けられるので、
狩人に限らず、意外と色んなクラスで有用かもしれません。

<hr size="1" />
<span style="font-size:large;"><strong>【片道勇者2 バグ修正いっぱい】</strong></span>

ここまでにたまっていた大量のバグの修正をしています。
どんな修正をしているかたまにはご紹介！
ただし言葉にしても意味の分からないバグが半分くらいあったのでそれは抜いてます。


●【バグ】メッセージウィンドウが消えるバグがいつのまにか出てたので修正。
新しく作ったピクチャのIDと干渉していました。よくある！
<span style="font-size: 80%">　→　なお、私はピクチャIDなどの管理をユーザDB(固定値DB)内で行っているので修正も一瞬です！
慣れた人はこの造りにされている方が多いはず！
（↓の右側あたりに注目。使っているID番号などを一覧できるようにしています）</span>
<img src="https://silversecond.net/data/p_diary5/20230805A.png" border="1" width="520">


●【バグ】『次元倉庫』内でだけ、付与付きの+2武器などを選んだときに
説明文に「付与」の情報が表示されないバグ修正。

●【バグ】ウディタの修正でスクリーンショットが保存できなくなっていたバグ修正。
プロ版機能に置き換えたら直りました。
<span style="font-size: 80%">　→　実は私専用に作った処理よりも、プロ版のスクリーンショット機能の方が機能的に強くて親切で安定してたりします。
自分一人が使うなら、使い方をミスると動かないような綱渡り仕様でもいいですからね。</span>

●【バグ】NPCに見せるアイテムを1個選ぶ画面で「決定」すると、
説明欄が消えずに残り続けるバグを修正。よくあります。

●【バグ】主人公へのダメージがシステムメッセージに出ないことがあるバグを修正。
<span style="font-size: 80%">　→　ついでに死亡時スクリーンショットに表示されるようにするため、
ゲームオーバー直後にもシステムログに最終ダメージを出すように修正。</span>

●【バグ】NPC仲間が仲間になったときに「『』が仲間になった！」と出るバグ修正。
<span style="font-size: 80%">　→　これは仲間NPCがマップ上から一時消滅してから表示されるメッセージなので、
『』の中味を「データXX番のキャラ名」で出したはずが
そのデータXX番の中味が空になっていて空欄になってしまっていました。こういうバグもよくあります。</span>

●【バグ】アイテム使用時の方向選択時、キーボードの場合だけ
方角が選べなくなるバグがあったのを修正。
<span style="font-size: 80%">　→　キーボードとマウスとパッド対応してるので一系統のみ
ちょっとだけ動かない現象が他にも出そうで怖い！！</span>

●【バグ】強制スクロールの『闇』によって次ターンのまれるはずの赤い点滅マスで
ターンを終えても死なないことがあるバグ修正。こういうのも困ります。

●【バグ】自分からのダメージで「(主人公)にHPを50%削られた！」と
出るのはおかしいので出ないように修正。

●【調整】押すと選択肢が出てくるカードには
白い吹き出しマークをカードの上に表示するよう修正。

こういうワンポイント修正、ひとまず先へ先への気持ちで
作ってる間はなかなか気付きにくいんですよね。
<img src="https://silversecond.net/data/p_diary5/20230805B.jpg" border="1">


●【バグ】ショップで「売る→キャンセル、キャンセル」と高速連打して画面を抜けると
画像が一部残るバグ修正。
しっかりピクチャのディレイリセットをしないと連打したときに画像が残りがちです。

●【調整】武器の「投げる」を「ターン消費なしの方向指定投げ」に修正。
それに伴って大量のバグが出たのでそれも修正。
<span style="font-size: 80%">　→　投げ武器アイテムと同じで、全ての「装備」もターン消費なしで投げられるようになりました。
さすがに「服」は投げても弱いですが、山の向こうに弱い敵がいて困るときは
脱いで山越しに投げてやっつけることもあります。絵面(えづら)がひどい。</span>

●【調整】防具や追加装備の「投げる」処理もターン消費なしに修正。

●【バグ】対象がいないときに投げ行動をすると、どの方向を向いていても
投げた物体がなぜか右上に飛んでいってしまうバグを修正。
投げ処理を作るとなぜかこういうバグ1回は起きます。

●【バグ】一度に1枚しか選べないカードを次々選択すると選択時の
点滅状態が残るバグ修正。超よくある！

●【調整】投げアイテムカードを選択したときは本番実行する前に
射程範囲が表示されるように修正！　直感的になりました。


<hr size="1" />
<span style="font-size:large;"><strong>【Steam版片道勇者(プラス)　バグ修正とエンジン更新】</strong></span>

Steam版の『片道勇者』を更新しようとしたら問題が発生しました。

というのも、ちょっといじっただけのEXEをアップしたはずが、
Steam側で認証されなくなって起動しなくなったのです！

SteamのSDKは9年前のものなので古すぎることが原因と考えましたが、
ウディタ2に使っているVisual Studio 2003だと
なんと新しいSDKが動かせないことが判明！
結局、Visual Studio2022に移行することになりました。

去年のうちにすでにVisual Studio 2022に移行したウディタ3を作っていたので
移行にかかる時間は数日で済みましたが、そうでなければ
3ヶ月くらいかかっていたでしょうから、去年Visual Studio 2022で
ウディタ3を作ってて本当によかったです。

さて、そんな色々あったSteam版『片道勇者』の更新内容は以下の通りです！


●ゲームエンジンをウディタ2→3にアップデートしました。
 - 全体の処理速度、起動時間が大幅に改善されます。
 - ゲーム内文字コードがUnicode(UTF-8)で処理されます。
　　といってもフォント文字化け現象自体は変化しません。
 - 今後セーブされるセーブデータのフォーマットが変わります。
Steam上で遊び続ける分には問題ございません。


●[英語版のみ] Windowsのシステムロケール（Unicode以外での言語設定）が
簡体字・繁体字・韓国語の場合、フォントの問題で文字が
期待通り表示されない問題がありました。
それらのシステムロケール上で起動された場合は見た目が近い
別のフォントに切り替える処理を追加しました。

<span style="font-size: 80%">　→　これ、同じフォントなのに「韓国語のときだけ横幅が大きくなってしまって画面からはみ出す」とか、
「簡体字や繁体字モードだと英語用のフォントが読み込めないことがある」など、
全角文字のアジア環境で色々なフォント問題が起きていました。
ウディタで世界向けに販売される方は注意が必要な点です。

気にされる方は、【ロケールエミュレータ】という他の言語環境にして
EXEを起動できるソフトもあるので活用してください！</span>


●ランチャー経由をやめ、「起動オプション」を選んで起動できるようにしました。
<span style="font-size: 80%">→　設定すれば「プレイ」を押しただけで直接プラス版を
起動できるようになったりしたのでちょっとラクです。</span>

◆おまけ質問：Steamdeckで片道勇者を起動できないの？
<span style="font-size: 80%">→　Steamdeckでリリースするためには特定の条件全てを満たすように
ゲームを作らなければならないのですが、現行のウディタでは
実現が難しい条件があって適用するのはまだ難しそうでした。
直せそうなヒントが思いついたら1つずつでも直していけたらと思います。</span>

<hr size="1" />
という感じで、ほぼずっとバグや細かいところを直してばかりで
前に進んでいる気分になりにくい週でした。
もちろんこれも前進といわれれば大きな前進なんですけども、
新しいものを作る方が「やってる感」が出ますね！　気分の問題です！！

とにかくどんな作業でも、目の前のやるべきことを全力で進めていきたいと思います！

また、<B><span style="font-size: 150%"><a href="https://www.silversecond.com/WolfRPGEditor/Contest/" class="red">第15回ウディコン</a></span></B>も
ひっそり開催中ですのでぜひお楽しみください！
やる気がある方、作品を応援したい方は審査もぜひお待ちしております！</div>

</body>
</html>