<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>ウディタ大規模アプデの機能 4</title>
<script>
function toggle(id){
 var e=document.getElementById(id);
 if(e.style.display==='none'){e.style.display='block';}else{e.style.display='none';}
}
</script>
</head>
<body>
<h1>ウディタ大規模アプデの機能 4</h1>
<div>2022-10-01 11:35:45</div>
<div><span style="font-size:large;"><strong>【ウディタ大規模アップデートで搭載される機能 4】</strong></span>

引き続き大規模アップデートの機能紹介！


<span style="font-size:large;"><strong>【ピクチャエフェクトに「変換」系エフェクトを追加！】</strong></span>

エフェクトの「ピクチャ」に「変換」系処理を追加しました。

この件は動画を作りましたのでこちらを見れば一目瞭然です！（2分の映像です）
↓
<iframe width="520" height="300" src="https://www.youtube.com/embed/fwlklTk3Fic" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

これらは一瞬で不可逆な変換を行うもので、一度かけた「変換」エフェクトは
そのピクチャが消去されるまで持続します。
つまり、何度も「ぼかし」エフェクトを重ねたりすることができます。
使えるのは今のところ以下の通りです。

<span style="font-size:large;"><strong>- 変換/色相彩度明度</strong></span>
　ピクチャの色の方向性・鮮やかさ・明るさを変化させます。

<span style="font-size:large;"><strong>- 変換/モノトーン</strong></span>
ピクチャを指定した色相のモノトーンに変化させます。

<span style="font-size:large;"><strong>- 変換/ぼかし</strong></span>
ピクチャをぼかします、一度にぼかせる量には限界があります。

<span style="font-size:large;"><strong>- 変換/階調反転</strong></span>
ピクチャの色を反転します。2回やると元の色に戻ります

※マニアックですが「レベル補正」(指定範囲A1～A2の明るさ範囲を
指定範囲B1～B2の明るさ範囲に変換）もあったほうが
色々できるので入れようかなと考え中です。

<hr size="1" />
<span style="font-size:large;"><strong>●エフェクト機能がいっぱい増加！</strong></span>
上の分もエフェクトの追加ですが、その他にも便利そうなエフェクト機能が
いっぱい追加されました。

<span style="font-size:large;"><strong>【ピクチャのエフェクト】</strong></span>

<strong>- 描画座標シフト2(角度・拡大率反映</strong>)
　→　拡大率や角度の影響を受ける「前」のXY座標をシフトさせます。
　　　ウディタ作者は、カードを複数のピクチャを重ねて作るときに便利でした。
　（文字や下地などを全て「同じ座標」の「中央」座標で重ねて出した後、
これでシフトさせて文字や絵などの位置合わせをすれば
回転・拡大しても1枚のカードとして動くように見えます）

<strong>- 不透明度補正[±]
- 角度補正[±]
- 拡大率補正[±]</strong>
このあたりは書いてある通りです。
いつも通り、縦横の拡大率が違うと角度補正は効きません。

<strong>- エフェクト全解除</strong>
ピクチャエフェクトを全解除できます（解除できるもののみ）。
まとめて消せるのがなかったので便利になります。

<strong>- ピクチャのコピー</strong>
パラメータや読み込んだ画像が全く同じピクチャを別IDにコピーします。
「カーソルを合わせたときだけ最前線に表示したい」ときなどに便利。

<strong>- ピクチャのID移動</strong>
指定したピクチャのIDを切り替えられます。
凝り始めるとこのコマンドと似た処理が求められる場面は多く、
従来のウディタでも「消去→別IDで表示」を一瞬で行うことで実現はできましたが、
これからはこのコマンド1つで実行できます。
処理を簡単化、軽量化するのに役立つと思います。



<span style="font-size:large;"><strong>【キャラのエフェクト】</strong></span>

<strong>- 不透明度補正[±]
- ｷｬﾗﾁｯﾌﾟを変更
- 高さ変更
- 強制パターン上書[0:ﾅｼ]</strong>
　キャラチップを「指定したパターン番号」の画像にして停止させます。パターン値はピクチャと同じ分け方です。
<strong>- 重ねｷｬﾗﾁｯﾌﾟを変更</strong>
以前も紹介しましたが元のキャラチップに最大5枚分、別のキャラチップを重ねられます（つまり全6レイヤーで着せ替えが可能です）。

<hr size="1" />
<span style="font-size:large;"><strong>【エディタ周りの修正・改善】</strong></span>

●イベント編集ウィンドウの検索窓に「置換」機能が追加！
●マップイベントウィンドウに「検索」機能と「行数」機能が追加！
<img src="../image/2022/20221001.png" border="1" width="520">
なぜかマップイベント側に付いてなかった検索機能を付けたり、
ついでに「あればいいのに」とたまに思うことが多い機能の
代表である「置換」機能を搭載しました。


●【マップ/コモンイベントウィンドウ】
検索ウィンドウの履歴文字列を10個まで保存するようになりました。
従来は特に履歴が保存されたりしておらず無意味でした。

なんだか履歴が保存できそうな検索欄の入力欄でしたが、
あれ自分でちゃんと実装しないと履歴が入らないんですよ。


●【コモンイベントウィンドウ】コモンイベント編集時、Ctrl+Rの
「直前のイベントに戻る」で前のイベントに戻ったとき、
「行数」も最後の位置に戻るように修正。
実質的にワンボタンで2つの場所を見比べながら作業ができます。


●【ゲームデータ作成】今後は暗号化バージョンが選択可能になります。
今は「Ver2.25～2.29」と「Ver3.00」だけに限られますが、
ゲームデータの暗号化バージョンを選べるようになります。
オンラインアップデートをする際、新旧の暗号化ファイルが混ざるとクラッシュするので、
古い暗号化方式のままにしたいときに利用できます。
（暗号化処理は定期的に新しいものを追加しています）

●【ゲーム基本設定】 「MIDIの再生方式」に
「MIDI音源を使わない[GuruguruSMF.dllも不要に]」を追加しました。
これを選択していると、ゲームデータの作成時にも
GuruguruSMF.dllがコピーされなくなり、
起動時に「GuruguruSMF.dllがないよ」という警告が出なくなります。
さすがに今の時代になるとMIDIを使わない方もいらっしゃいますからね！

<hr size="1" />
<span style="font-size:large;"><strong>【ゲーム側の改善点】</strong></span>

●【座標取得】イベントコマンドで得られる「主人公」の座標が正確になるよう修正しました。
　たとえば【変数操作+】による「主人公」の「画面X・Y座標」などです。
　おそらくスクロール値も正確になっていると思われます。
　
→　従来は「1フレーム前の座標値」が取得されていたため、主人公のキャラチップにピクチャを重ねようとしてもどうやっても1フレーム分ズレる現象がありました。
　これは従来、「イベント後に主人公のキー入力や位置情報が更新されていたため」で、キー入力と位置情報を分離し、イベント前に位置情報だけ更新する形にしました。

→　処理順が変わった都合上、キー入力による「主人公」の移動が動き始めの1フレームだけ遅れることになるので、1フレームしか猶予のない逃走ゲームなどはVer3.00への更新によってクリア不能になる場合がございます。
　過去の挙動に戻したい場合は、「ゲーム基本設定」の「Game.exe 動作バージョン調整」で「Ver2.29時点の挙動で動作」に切り替えることで対応できます。


●【エフェクト】キャラ・ピクチャのシェイク回数として10万回以上を指定すると「無限回」になるよう修正
正直ここまでの数値を入れるときは無限にしたいときの方が多いので、無限回になるようにしました。

●【エラー】 緑帯エラーの表示中にF12リセット、あるいは
F11更新（まだF11はクラッシュしやすいです！）できるように修正。
緑帯ループに入ったときにリセットできなくて面倒臭かったので！

●【ピクチャ表示一覧】テストプレイ中、「Shift押しながらF7」を押すことで
「マウスカーソルが重なっているピクチャ」だけを
「ピクチャ表示一覧」に表示できるよう修正。

たくさんのピクチャがあっても、指示したところだけの情報を得やすくなります。
ついでに、最後まで見ないと終われなかったのを
「Ctrlキー」を押せば途中でも中断できるよう修正。


<hr size="1" />

今回ご紹介するのは以上の通り！
他にもまだ色々ありますが徐々にご紹介していきます。

リリース時期ですが、色々やってみた感じ、下手すると残る作業の中で
一番大きい「Unicode対応」だけで1ヶ月くらいかかるかもしれない可能性が
出ているので、10月中のリリースは怪しい感じです。
（直す場所が最低でも4000箇所以上あります）

どうしても今年中が難しくなりそうなら
「Game.exeとEditor.exeの一部」だけの
半端なUnicode対応で一旦区切ることも予定しています。
文字コード周りは徐々に変えるということができないので、
できればこの機会に重要箇所だけでも一気にやってしまいたいと考えています。

<span style="font-size:x-small;">（なお半端なUnicode対応にするとどうなるかというと、
「エディタで中国語を入れてもイベントコマンド欄の中国語だけ文字化けする」感じになります。
ただ、文字化けするだけで入力自体はできるようになるので、従来よりは一歩進みます。
なんせ従来だと中国語の入力すらできませんでしたからね！）</span>

という感じで、引き続きやれる速度で作業を進めていきます！</div>

</body>
</html>