<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>【ウディタ】セキュリティ向上作業、いったん完了!!</title>
<script>
function toggle(id){
 var e=document.getElementById(id);
 if(e.style.display==='none'){e.style.display='block';}else{e.style.display='none';}
}
</script>
</head>
<body>
<h1>【ウディタ】セキュリティ向上作業、いったん完了!!</h1>
<div>2024-04-13 10:20:52</div>
<div>この2週間も引き続きウディタの
セキュリティアップデートのために費やしておりました！
1ヶ月近くもの時間をかけてしまったのでウディタ作業費は
超大赤字ですが、セキュリティやデータ処理について
たくさんのお勉強ができたので人生ではプラスの期間でした。

ひとまず最新版ウディタは一通り動作するようになったっぽいので、
ウディタ公式にてVer3.311をアップしております！
とはいえまだちょいちょいバグが残ってる匂いがするので、
慎重な方はもう少し待ってからお試しください。

<a target="_blank" href="https://silversecond.com/WolfRPGEditor/"><span style="font-size: 200%">【WOLF RPGエディター公式ページへ】</span></a>

<img src="../image/2024/20240413.jpg" border="1" style="max-width:520px;" loading="lazy">



<HR><span style="font-size:large;"><B>◆ウディタのセキュリティ向上、プレイヤーへの影響はある？</B></span><HR>
ウディタに対していろいろセキュリティ上の
基本的な対策を行ってみたのですが、その中でも
プレイヤーの方にダイレクトに影響が出る可能性があるのは
『DLLインジェクション』への対策です。

　『DLLインジェクション』とは簡単にいうと
「本来そのプログラムが使わないDLLを注入して、
強引にプログラムの処理を上書きする」手段で、
応用すれば内部データを抜き取ったりするような悪いことにも使えます。

そしてこれを対策したことによるプレイヤーの方への影響としては、
<B><span style="color: #d50000">『別アプリの内部データを使用したり処理を上書きするような個人制作ソフト』</span></B>
を使っている場合、Game.exeの起動時に以下のようなエラーが起きて
起動できなくなる可能性が出てくるという点です。

<img src="https://silversecond.net/data/p_diary5/20240413A.jpg" border="1" style="max-width:520px;" loading="lazy">
<span style="font-size: 80%"><B>　↑正規の署名がないDLLが読み込まれたと出てゲームが停止！　
企業製ソフトならたいてい正規の署名があるので大丈夫ですが、
個人制作ソフトだと正規署名が付いてないことが多いです。お高いんですよね！</B></span>


<B>※もし↑が出て遊べなかった場合、<span style="color:#CC0000">Gameを「管理者権限で起動」することで
このエラーを回避できるようですので、よければお試しください。
Game.exeの上で右クリック→「<strong>管理者として実行</strong>」を選べばOKです。</span>
このエラー文そのものにも追記しておきます！
(2024-07-19追記)</B>


なおこの「DLLインジェクション」技法は悪いことに
使われるだけじゃなくて、
「アクティブになってるウィンドウの上にかわいいマスコットキャラを表示する」
みたいなソフトでも昔使われていたと思います。

たとえば
「実行中のソフトのウィンドウ座標処理をDLLで乗っ取り、そこから
座標情報を抜き取って表示する（+ 元の処理はそのまま再現する）」
ことでウィンドウの上にキャラを乗せる処理を実現していたわけですね！

最近はそんな処理をすると厳しめのウィルスソフトに
バチバチに怒られたりする予感がしますので、
2010年すぎからこういったソフトも段々なくなってしまった印象があります。

「ウィンドウを追随してくれるようなデスクトップマスコット系アプリが
なんで全然増えなくなったの！？」と私が思い始めた時期がその辺りでした。

<span style="color: #42a5f5"><span style="font-size: 80%">（たとえば私が使っていた『ClockLauncher』というフリーソフトの2009年版では
アクティブウィンドウのそばにランチャーが自動的に移動する機能があり、
普通にそこでDLLインジェクションが使われていたためかソフト起動中は
最新Game.exeを実行できなくなりました(上の画像)。
それゆえか、『ClockLauncher』の特定のバージョンからは
その機能がなくなっています。
このソフトは2となった今でも更新されててすごい！）</span></span>


ちなみに、セキュリティソフト自体もGame.exeに
『DLLインジェクション』することがありますが、
それには正規の署名が入っているのでウディタ上でもエラーは起きないはずです。
セキュリティソフトのDLLインジェクションは
『勝手に元の処理を上書きして、怪しい処理が実行されてないかを
監視する処理を加えている』わけですね！　たぶん！

おかげで今なら私も、どういった造りでそういったことを
実現してるのか、ちょっとだけ分かるようになってきました。




<HR><span style="font-size:large;"><B>◆セキュリティの難しさとか雑談とか</B></span><HR>
ここからはこの3週間にあったとりとめのないお話です。

<B>●安全性のチェックを頻繁に入れるほど重くなるので
パフォーマンスのバランス取りにすごい時間がかかった！</B>
<span style="color: #42a5f5"><span style="font-size: 80%">　→　まず色んな処理の実行時間を検証するのにけっこう時間がかかりました。
「軽い処理で先にチェックして変化を察知したら重い処理を行う」といった組み方を、
かなり細かく作る必要がありました。</span></span>


<B>●新しい暗号化処理を作ったらうまく復号化できなくて地獄を見た！！</B>
<span style="color: #42a5f5"><span style="font-size: 80%">　→　当たり前ですが暗号化と復号化って1バイトだけ処理をシクっただけでデータがグチャグチャになるんですよ！
ヤケクソでSuno AIさんにこんな歌（　↓　）を
作ってもらったりしてました。作業用BGMとして。</span></span>
<blockquote class="twitter-tweet"><p lang="ja" dir="ltr">暗号化処理のプログラミングにシクったときの歌<br>（現在進行形） <a href="https://twitter.com/hashtag/SunoAI?src="hash&amp;ref_src=twsrc%5Etfw"">#SunoAI</a> <a href="https://t.co/lmQrOURuH0" class="red">pic.twitter.com/lmQrOURuH0</a></p>&mdash; SmokingWOLF@片道勇者2開発中/ゲーム開発者 (@WO_LF) <a href="https://twitter.com/WO_LF/status/1774406905655611489?ref_src=twsrc%5Etfw" class="red">March 31, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>


<B>●試行錯誤してたら部分的な処理速度が最初の28倍になって笑ってしまった。</B>
<span style="font-size: 80%"><span style="color: #42a5f5">　→　ファイルを開く速度に影響するので、どうにか暗号化と復号化の速度を上げようといじってたら
最終的に処理速度が最初の書き方の28倍くらいになって笑ってしまいました。
最初の書き方は誰でも書きうるコードだったのに、そこから
CPUが処理しやすいように崩していったら最終的にこれ！
プログラミングの深さがヤバすぎますよ！

ウディタVer3のときも、超がんばってVisual Studio2003から
Visual Studio2022に環境を変えただけで部分的に速度10倍になったりして
驚きましたが、そういった最適化を受けやすい造りでコーディングする効果の
凄さに衝撃を受けました。これからはCPUに優しい組み方も考えなきゃ……。</span></span>


<B>●親がとうとう要介護4認定がでそうな状態になっててさらにしんどい！！</B>
<span style="color: #42a5f5"><span style="font-size: 80%">　→　前は要介護3認定だったんですが
ケアマネさんに見てもらったら要介護4かもって言われました。要するに大変です。
でも空き時間がないわけじゃないので開催まで残り100日を切った
ウディコンはなんとかがんばります！

介護において「半端に動ける状態の方が恐い」という意味が
理解できる段階になってきています。</span></span>



<HR><span style="font-size:large;"><B>おまけ　ウディタ内でできるセキュリティ対策記事紹介</B></span><HR>
K-Shin07さまが、ウディタのゲーム開発者側でできる
セキュリティ対策の記事を書かれていたのでご紹介です！

【ウディタでのゲーム開発者が行えるセキュリティ対策】
<a target="_blank" href="https://ci-en.net/creator/16060/article/1111345">https://ci-en.net/creator/16060/article/1111345</a>

「チェックサムによる改ざん検知」「不正なゲーム実行を阻止」など、
ゲーム内からでもできる実用的なテクニックが挙げられています！

特に「チェックサム」は、オンライン要素があるゲームだと
通信内容が改ざんされてありえないスコアが送信されたりしちゃうことも
たまにあるので、そういった場合の防衛策としても有用です。

<HR>

ということで、今回のセキュリティアップデートはゲームデータの
いくらかの防衛力アップには繋がると思いますので、
気になってた方はよければぜひご利用ください。

とはいっても完全な防御ができないのがこのセキュリティ業界。
限界はありますのでその点はご了承ください。
超有名AAA作品のゲームデータだってたぶん素晴らしい暗号技術が
使われてるでしょうに、だいたい解凍されちゃってますしね。

ウディタ本体もまだもう少し様子見しないといけなさそうなのと、
『ウディタ翻訳サポートツール』の方にも今回の修正を
取り入れる必要があるので、もうしばらくプログラミングをがんばります。

一通り片付いたら、1ヶ月ぶりに自分のゲーム開発が再開できます。
がんばっていきます！</div>

</body>
</html>