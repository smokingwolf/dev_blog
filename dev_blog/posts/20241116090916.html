<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>ウディタ3.5開発中その5　自動移動･サウンドのパン機能など</title>
<script>
function toggle(id){
 var e=document.getElementById(id);
 if(e.style.display==='none'){e.style.display='block';}else{e.style.display='none';}
}
</script>
</head>
<body>
<h1>ウディタ3.5開発中その5　自動移動･サウンドのパン機能など</h1>
<div>2024-11-16 09:09:16</div>
<div><TABLE padding="15px"><tr><td align="left" style="line-height: 1.5; word-break: break-all;">　ということでウディタ3.5開発の経過報告、その5です！
　「これまで欲しかったけど入れられなかった新機能」をまだまだいっぱい追加中！
　今回もご紹介していきます！

<HR><span style="font-size:large;"><B>●動作指定に「自動移動」機能を搭載！</B></span><HR>
　以前、隠しコードで「経路探索機能」を実装しましたよ～とお伝えしましたが、次はもっと使いやすいよう、「動作指定」に落とし込んでみました！
　それがこの「自動移動」コマンドです！
　紹介映像を作りましたのでよければまずそちらをご覧ください！

　※映像は開発中のものです
<iframe width="520" height="300" src="https://www.youtube.com/embed/8xnDOyTydN4?si=KHu0qyH1UplKhK1i" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

　この「自動機能」、行き先を指定すれば勝手にそこまで経路を判断して歩いて行ってくれます！
　モードとしては[単純][スマート][大負荷]の3種が用意されています。それぞれ以下の違いがあります。

<img src="https://silversecond.net/data/p_diary5/20241116A.png" border="1" style="max-width:520px;" loading="lazy">
　
- <B>自動移動[単純]</B>：最初に「マップ通行設定のみ(Evはないものとする)」で移動ルートを計算し、以後はルート通り進みます。進路上に他のイベントや主人公がいた場合は止まります。
　→　プレイヤーやイベントが道を塞いで止まってしまっても問題ない状況向け。
　
- <B>自動移動[スマート]</B>：最初に大局的な進行ルートを「マップ通行設定」のみで取得し、基本はそれに沿って移動しますが、他イベントや主人公が経路を塞いでいた場合は少し迂回して移動します。
　→　それなりに賢く移動させたい場合はこれがおすすめです。負荷もほどほど。
　　ただし「イベントでゴールまでの通路が塞がれている」場合は途中で止まってしまいます。
　
- <B>自動移動[大負荷]</B>：大局的な進行ルートも「マップとイベント両方込み」の当たり判定で取得し、数歩ごとに何度もおおまかなルートを再取得し直します。負荷が高いです。
　→　イベントが完全に道を塞いでいて、非常に遠回りせねばならない状況でも経路探索に成功する可能性があります。
　　ただし「ランダム移動するキャラがたまたま経路を塞いでいる」場合もそれに敏感に反応して大局的な進行ルートを変えてしまったり、「道がない」と判断して一時的に止まってしまったりする場合があります。

- <B>「自動移動一歩のみ」オプション</B>: 自動移動のゴール地点まで行かず、1歩移動した時点で処理を終了するオプションです。ゴール地点が頻繁に変化する状況で有用です<span style="color: #2196f3"><span style="font-size: 80%">（たとえばこれナシで「自動移動」すると、追いかけっこのときも「3秒前の主人公の位置」を追い続けてしまい、そこに一回着くまで自動移動経路が変わらない問題が起きます！　そういうときに「一歩のみ」オプションをオンにして「動作を繰り返す」ようにしておけば、1歩で終了→最新の場所を経路探索して1歩移動→……と繰り返すので常に最新の位置を追い続けてくれます。ただし負荷は高くなります）</span></span>


　という感じ！　基本は、キャラを避けて移動させたいなら「スマート」、そうでないなら「単純」モード、ゴール地点が移動する場合は「自動移動一歩のみ」をオンにする、で問題ないと思います！

<B>【これからの動作指定】</B>
　動作指定でこれまで↑↑→→↓↓←↑←↑みたいに1歩ずつ指定していたのが、今後は行き先までの経路を「自動移動」ワンボタンで設定できるため、動作指定の作業はかなり簡略化されると思います！　後述の「マップ表示」機能と合わせればさらにサクサク入力可能なはず！

　もちろん機能面での広がりも大きく、「スマート」自動移動で「たくさんイベントが歩く中をうまくよけて通らせる」ことがワンボタンでできるようになったのは非常に大きな点です。
　想像してみてください。酒場のウェイターやウェイトレスさんが、歩いている人を避けながらテーブルに食事を配膳しにいったり食器を回収しにいくような指定だってものすごく簡単にできるようになるんですよ！
　
　なんなら「自動生成されたマップ」や、「自分で1マスずつ壁を配置して作った村」内ですら、簡単に道を判断して移動させられるようになるというのはものすごく大きなメリットのはず！　仕事場に行って働いて、夜になったら自分の家のベッドに帰るなんて処理も簡単！
　作れるゲームの幅も一気に広がるはずです！


<HR><span style="font-size:large;"><B>●動作指定中の「マップ表示」機能も！</B></span><HR>
　そして引き続き「動作指定」画面の話なのですが、ウディタ3.5からは動作指定を設定中に並行動作するマップ画面を表示させることが可能になります！　むしろどうして今までなかったんだ感がありますが、実装はすごく面倒臭かったです！

<span style="color: #808080">　<span style="font-size: 80%">↓並行して表示できる「マップ画面」搭載！</span></span>
<img src="https://silversecond.net/data/p_diary5/20241116B.jpg" border="1" style="max-width:520px;" loading="lazy">

　このマップ画面は、「クリックした地点の座標」や、「そこにあるイベント名」を確認できるだけでなく、<span style="color: #d50000"><B>【ダブルクリックすると動作指定画面の「座標指定」欄にその座標がセット】</B></span>されます！

　なので今回の「自動移動」コマンドと合わせれば、

<span style="color: #2962ff"><B>　マップをダブルクリック（座標が格納される）　→
　「自動移動」をぽちっ　→
　次の移動先をダブルクリック　→
　「自動移動」をぽちっ</B></span>

　という手順を繰り返すだけで、あっという間に経路指定ができるのです！
　もうこれまでのように座標をメモしながら↑↑→→とか一歩接近とか入力しまくらなくてもいいんです！　
　
　これによって動作指定周りの入力効率が冗談抜きで10倍くらいになると思いますので、キャラを動かすのもこれまで以上に気軽にできると思います。


<HR><span style="font-size:large;"><B>●サウンドのパン機能！</B></span><HR>
　お待たせしました！　「サウンド」コマンドについに『パン』機能が搭載されます！
　その前に「パン」って何？って思われる方も多いと思いますが、これは「音の左右バランスを調整する機能」のこと！　右から鳴らすとか、ちょっと左から鳴らす、みたいなことができるわけですね！
　
　以下はパンの見本映像！　ヘッドフォン推奨です<span style="font-size: 80%">（画質が低すぎるとモノラル音声になってパンが体験できないので、その場合は画質を「360p」以上に上げてみてください）</span>
<iframe width="520" height="300" src="https://www.youtube.com/embed/dxk-pMUYuEA?si=n1CfRVAs3ON0B3th" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>

　上の映像にあるように、「BGM・BGS」の再生においては、同じファイル名を指定して違うパンの値をセットすることで、「再生を止めずに」パンだけ変更が可能です！
　効果音は「再生開始時にしかパンをセットできません」のでその点はご注意を！
　もし右から左にぴゅ～んと流れる音を流したい場合は「BGS」などをご利用ください。
　
　このサウンドのパン機能、音の位置にこだわる場合は、たぶんどんなゲームにでも使えます。
　「右から戦闘の音が聞こえる！」といった情報はアクションゲームでも有用ですし、ホラーゲームで部屋の前を通り過ぎていく何者かの足音を表現したりするのも面白そうですね。
　パンは「-255（左）～0（中央）～255（右）」の範囲で設定可能で、いつものように「変数」でも指定できます。


<HR><span style="font-size:large;"><B>●DBやコモンからのデータベース参照が「タイプ名」でも可能に！</B></span><HR>
　このタイトルを見てすぐ意味が分かる人は相当のウディタリアンです！
　データベースの「データ名」や「データ内容の特殊設定」、コモンイベントの「入力設定」などにおいて、データベースから「データ名」を読み取って番号と一緒に並記する機能があります。それを「データベース参照」と言うのですが、これまではDBのタイプには「番号」しか指定できませんでした。
　が！　Ver3.5からは「タイプ名」の【名前】でも指定が可能となります！　以下の画像のように！

<img src="https://silversecond.net/data/p_diary5/20241116C.jpg" border="1" style="max-width:520px;" loading="lazy">

　「タイプ呼び出しなんて【名前】で呼んでも【番号】で呼んでも同じじゃん」と思われる方もいらっしゃるかもしれませんが、使い込んでいくと全然そうじゃないんですよ！　開発が長期に渡ると「DBのタイプの場所（番号）を入れ変えたい～！」ってなることが意外にあって、そんなとき番号でタイプ指定してるとヘタに場所（タイプ番号）が変えられなくて困るんですよ！
　一方、そこを「名前」で指定しておけば、DBタイプの番号が変わってもそのまま読み込まれるので安心！　というわけです！（まあ番号は変えられても、今度はDBタイプ「名」の方が簡単には変えられなくなるんですけども。でも名前は普通変えないですからね）

　ということで、これからはデータベースも整理しやすくなるでしょう！
　私もいま開発中のゲームで「DB並べ替えたいなあ、でも面倒臭くなるしなあ」と50回くらい思ったので、この機能を使ってきれいに並べ替えたいと思います。

<HR><span style="font-size:large;"><B>●オートタイルアニメ速度変更！</B></span><HR>
　ウディタのオートタイルは、画像を横に長くしてアニメパターンを作っておくと自動でアニメーションさせることができるのですが、これまでは「毎秒3コマ（20フレームに1回）」のスピードでしかアニメーションさせられませんでした。
　ですが今回、オートタイルにフレーム数を指定する手段が搭載されます！

　たとえば「Water_Auto.png」というオートタイルがあったとき、「Water_Auto<B>_FRAME=5</B>.png」という感じに「<span style="color: #d50000"><B>_FRAME=??</B></span>」と入れると、1コマのアニメーション時間をそのフレーム数に変更できるのです！（※1フレーム=1/60秒）

<span style="font-size: 80%"><span style="color: #808080">↓滝のアニメーション速度を変えた見本</span></span>
<a target="_blank" href="https://twitter.com/WO_LF/status/1853416989018214459">https://twitter.com/WO_LF/status/1853416989018214459</a>

　これまでも強引にピクチャでオートタイルを再現してアニメーション速度を変えることもできなくはありませんでしたが、今回からはもっとマシな方法で速度を変更できます！　よければぜひご利用ください！

<HR>
　という感じで、今回も新機能盛りだくさん！
　次がたぶん最終のご紹介になると思います！　つまり公開もおそらく間近という雰囲気になってきますので、ご期待ください！

　とはいえ、今回いじった分がかなり多くて致命的なバグもまだ結構ポコポコ出ているため、いつ出せるかははっきりと明言しにくい状況です。「11月末か12月頭くらいに出せたらいいなあ！」くらいで見込んでおりますが、あまり信用しすぎずにお待ちください。
　</td></tr></table></div>

</body>
</html>