<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>Unityを使ったウディタのSwitch移植！</title>
<script>
function toggle(id){
 var e=document.getElementById(id);
 if(e.style.display==='none'){e.style.display='block';}else{e.style.display='none';}
}
</script>
</head>
<body>
<h1>Unityを使ったウディタのSwitch移植！</h1>
<div>2020-10-10 14:29:59</div>
<div><span style="font-size:large;"><strong>【ウディタのSwitch移植情報！】</strong></span>

このたび、私のゲーム『片道勇者プラス』がSwitchに移植されました！
ので、今回はウディタ移植に関する情報をこの記事にまとめさせていただきます。

まずこれは前にもご紹介しましたが、
移植に関するエスカドラ様へのインタビュー記事が出ました（↓）ので、
特にウディタユーザの方で気になる方はぜひご覧ください！
具体的にどうやってウディタ作品をNintendo Switch上で動かしているのかが説明されています。

<strong>【「家庭用ゲーム機へ移植不可能」とされた
『片道勇者』がNintendo Switchデビュー。
難しすぎる移植はいかにして実現されたのか？】</strong>
<a href="https://automaton-media.com/devlog/interview/20200617-127872/" class="red">https://automaton-media.com/devlog/interview/20200617-127872/</a>

リンク先記事のざっくりとした内容としては、

<span style="color:#990000"><span style="font-size:x-small;">●ウディタの基本プログラムをUnityのネイティブプラグインにしてUnity上で動かした。
<strong>自分をWindowsのゲームだと思い込んでいるソースコードが
Nintendo SwitchのUnity内でそうとは知らずに走っている。</strong>
（このやり方でちゃんとなめらかに動かせてるのが一番ヤバい！
将来的に考えれば効率的な方法ではあるものの、普通こういうやり方をしたら
動作がものすごく遅くなって結局「その作品1本だけの」移植をした方が楽という話になりやすいので、
「ウディタまるごと移植」はむしろスーパー技術者にしかできないシンプルな力業です）

●移植の話は技術的に困難で、私(SmokingWOLF)ではなかなか実現の見込みがありませんでした。
また、実は外部からの移植案件も来ていて、ご協力させていただいたのもあるのですが、
うまくいったという連絡も今のところありませんでした。
つまりその中で初めて成功させたエスカドラ様はすごいってことです！

●エスカドラ様によると、『今後はウディタ作品の移植は短い時間で可能』とのこと！
様々なチューンや審査が必要なので一瞬で完了するということはないけど、
ウディタ作品からコンソールゲームがリリースされるのを惜しみなく協力していきます！
だそうです！
（そして記事の最後に株式会社エスカドラ様のお問い合わせページへのリンクが貼ってある。
カモーンウディタリアーン！）
</span></span>
という感じでした。

<hr size="1" />
<span style="font-size:large;"><strong>【ウディタのSwitch移植の技術的な話題】</strong></span>

そして『片道勇者プラス』を移植してくださった株式会社エスカドラ様が、
ウディタのSwitch移植に関する技術講演をしてくださいました！

動画はこちらからご覧いただけます！（Unity Japan公式の動画なので安心！）
↓

<strong>『もはやWOLF RPGエディター製ゲームがコンソール機にも出せる！ 
 - Unityネイティブプラグインと化したウディタ -』</strong>
<iframe width="530" height="300" src="https://www.youtube.com/embed/Elt5-cAROlc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

全部見るの大変！　とかウディタユーザの人に重要なのはどこ？
というのが分からないと思いますので、今回はこの講演の内容について
ざっくりポイントになりそうなところをピックアップさせていただきます。
（※万が一、中の人に怒られたりしたらこの記事は消滅します）

<hr size="1" />
<strong><span style="font-size:large;">【ウディタ作品の移植について】</span></strong>

<strong>◆『片道勇者』が他プラットフォームへの移植ができなかったので、
エスカドラ様がUnityネイティブプラグインを開発！</strong>


<strong>◆今後の取り組みは？</strong>
- いま現在、代表的なウディタ作品の移植を行っている

- 代表タイトルの移植を進めることでUnityプラグインの精度を高めているところ


<strong>◆今後のプランとしては以下の2つを考えているとのこと。</strong>
①ウディタ製ゲームの移植開発を共同で行う（売り上げからロイヤリティを分ける形）。
②エスカドラ様が受諾開発として移植開発を行う（まとまったお金を払って移植してもらう形）。

究極的には、<span style="color:#CC0000"><strong>『誰でも使えるウディタ製ゲームUnityプラグインの汎用化を目指したい』</strong></span>
だそうです！　すごい！
もちろん、労力に対してどれだけお金が生みだせるかによるでしょうけれどね。


<strong>◆【宣伝】株式会社エスカドラはNintendo Switchを始めマルチプラットフォーム展開ができる！</strong>
→　なのでエスカドラさんまでご相談ください！　とのことです。
　
<hr size="1" />
<strong><span style="font-size:large;">【技術的な部分の話】</span></strong>

ウディタユーザの人にも、というか私に分かった範囲の点だけピックアップします。


<strong>◆移植したのはWOLF RPGの【Game.exe】だけ。エディターは移植してない。</strong>


<strong>◆移植方法の候補は3つあった（中には「Switch版DXライブラリ」を使う案もあった）が、
今回はUnityを使ってウディタのC++コードをそのままネイティブプラグインにした。</strong>
<span style="color:#8888FF">→　それぞれのやり方の細かいメリット・デメリットが講演内で語られています！
Switch版DXライブラリなどを使う案もあったそうです。</span>


<strong>◆ウディタプラグインで処理して、Unity側に命令をためておいて実行する形を取ったよ。</strong>
<span style="color:#8888FF">→　高速化においてはUnityやC#のこれこれこういう機能を使って高速にしたよ！
というのが細かく紹介されています。</span>


<strong>◆音声ファイルについてはMIDIファイルが再生できなかったので
原作者自身がMIDIをそのままWAVファイル化したのを使ったよ。</strong>
<span style="color:#8888FF">→　講演では出てませんが、実は私が130曲中の1曲だけやらかして
Switch版で山賊戦のBGMを間違えました。ごめんなさい。今は戻っています。</span>
<span style="color:#8888FF">→　BGMはROM容量の75％ほどを占めた。まあ元が80MBのゲームでしたから
300MB近く増えるとそうなりますよね……。</span>


<strong>◆セーブデータにおいては仮想ファイルシステムを用意したよ。</strong>


<hr size="1" />
<strong><span style="font-size:large;">【作ってみて起きた問題】</span></strong>

<strong>◆一部処理で期待したほどの速度が出なかった！　が他の手段を試してうまくいった。</strong>
<span style="color:#8888FF">→　インスタンシングがどうとか。知らない言葉ですね……。</span>

<strong>◆環境によるC++の挙動の違いがあった。</strong>
<span style="color:#8888FF">→　C++のchar型の挙動が環境によって違う意味になる。
→　他にも、私がウディタ内でC++のすごい危険な使い方をして高速化している場所があり、
それがコンパイラの差で違う動作になってしまっていました。</span>

<hr size="1" />
という感じでした！

私に分からなかった部分はピックアップしていませんので、
気になる部分があればぜひ、講演の動画を直接ご覧ください！

今回の講演で一番大きい情報は、やはり
<strong>「最終的にはUnityプラグインを汎用化したい（みんなが使えるようにしたい）」</strong>
というところではないでしょうか。

そうでなくとも、お金を積めば個別に移植作業をやってくださるっぽいので、
「このゲームならXXXX万円は儲かるからXXX万円くらい出して移植してもらうぜー！」
という自信があればエスカドラ様にご相談されてもいいと思います！
でも私でも3桁万円出すと猛烈に赤字になりそう。

なお、<a href="https://www.youtube.com/watch?v=GRAjefD7Rfw" class="red"><strong>PLAYISM Game Show</strong></a> で挙げてくださっていましたが、
この技術を使って、今は『<a href="https://twitter.com/sen_old/status/1308256664026411008" class="red"><strong>マッドファーザー</strong></a>』というゲームの
Nintendo Switch展開のプロジェクトが進んでいるようです。
『マッドファーザー』もウディタ製の元フリーゲームで、私も翻訳関連やSteam展開などで
今もこっそり技術サポートさせていただいております。

そんなわけで、ウディタ作品の家庭用ゲーム進出はまだまだ広がっていきます！
気になる方は今後もぜひ注目してください。</div>

</body>
</html>