<!DOCTYPE html>
<html>
<head>
<meta charset='utf-8'>
<title>ウディタ大規模アプデの機能 3</title>
<script>
function toggle(id){
 var e=document.getElementById(id);
 if(e.style.display==='none'){e.style.display='block';}else{e.style.display='none';}
}
</script>
</head>
<body>
<h1>ウディタ大規模アプデの機能 3</h1>
<div>2022-09-03 13:20:51</div>
<div><span style="font-size:large;"><strong>【ウディタ大規模アップデートで搭載される機能 3】</strong></span>

引き続き大規模アップデートの機能紹介！
最近はRPG向けの基本機能でありながらおざなりになっていた、
タイルセットやマップ周りのオーバーホールを行っていました。

動画での紹介を見たい方はこちら！
↓
<iframe width="520" height="300" src="https://www.youtube.com/embed/7bUmzgMqIrc" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>

<hr size="1" />
<span style="font-size:large;"><strong>●マップ編集画面が強化！</strong></span>

マップエディタの基本処理をほぼまるっと作り直しました！
これによって、だいぶ性能限界が上がりました。
あと使いやすさもアップさせています。

<strong>- ほぼ無限サイズのマップでも編集可能に！</strong>
→　従来は長辺500マス以上あたりになるとマップが表示されなくなってしまい、
事実上それ以上のサイズが編集不能だったという不具合を抱えていましたが、
Ver3からそれが解消されます。1000x1000マスのマップでもしっかり編集可能！
　（メモリの問題でクラッシュしない程度の制限はかけるかもしれません）

<strong>- マップが大きくても処理速度が重くならない！</strong>
→　これまでは大きいマップほど何か触るたびに重かったりしたと思いますが
これからはサイズにかかわらず編集負荷が一定になります。

<strong>- 「一手戻る」が超速に！　+　Ctrl+Zでも戻せるように</strong>
→　大きいマップだと押しても4～5秒くらい待たないと一手戻せなかったのが、
今はもうほぼ一瞬で戻せます！　快適！　Ctrl+Zでも戻せるようになります。

<strong>-  EditorGraphic.datが不要に！</strong>
→　ほぼどうでもいいことですが外部においていた画像をEditor.exe内に内蔵できました。


<strong>- 「チップ選択ウィンドウ」でホイール押しながらドラッグでスクロール可能に！</strong>
　いちいちホイール回転とかスクロールバーさわらなくても
　肌感覚で高速スクロールできてだいぶチップ選択がスムーズになります。

<hr size="1" />
<span style="font-size:large;"><strong>●タイルセット画面が強化！</strong></span>

<strong>- レスポンス向上</strong>
大きいマップチップだと、クリックしながら
ザーっと横移動したとき選択したチップの隙間ができるくらいには
レスポンスが悪かったので、高速化できる処理を加えてみました。
たぶん反応頻度が数倍くらい速くなったと思います。

<strong>- オートタイル15→23個に増加</strong>
さすがに私も足りなかったのでオートタイルを追加しました。

<strong>- 32pxと48pxサイズ表示切り替え機能追加</strong>
タイル一覧の表示サイズを32pxと48pxに
切り替えできるようになりました。

<strong>- タグ番号のコピー＆ペースト機能追加</strong>
タグ番号の編集時、Ctrl+右クリックでタグ番号コピー、
Ctrl+左クリックで貼り付けできるようになりました。
55番タグ（「00」から10回クリックしないといけない）を
大量に設定しようとすると泣きそうでした。

<strong>- タイル画像別の通行設定をCSVで読み書きできる。</strong>
オートタイルなら1タイル分、基本タイルセットなら8×縦列分、保存できます
CSVで入出力できますが内部値で保存されており、
人間が読んで直感的に分かる値にはなってないのでお気をつけください。

法則性が分かれば自分で計算できるかもしれませんし、
基本チップの通行設定の番号リストを作っておけば
それを貼り付けて設定することはできると思います。


<strong>- タイル画像を「読込」したときに前述のCSVも同時に読み込める</strong>
<img src="../image/2022/20220903.jpg" border="1" height="400">
タイル画像を通行設定付きで配布したい人に朗報！
前述の通行設定CSVは、「同じファイル名のタイル画像を読み込むとき」に
自動で読み込むか聞いてくれます！　便利。


<strong>- タイル部の操作追加</strong>
　→ ホイール回転でスクロール可能に
　→ 中クリック押しの上下ドラッグでスクロール可能に

タイル設定画面のタイル部分を操作してるときに
「なんでこの操作ないんだよぉぉぉ！！」ってなったので入れました。
実装されるのが遅すぎた感がありますがだいぶテンポ良くなります。


<strong>- 「タイル表示部分」に通行設定CSVをドラッグするとそこに通行設定を読込可！</strong>
「パーツ画像＆パーツの通行設定CSVで公開」みたいな配布方法も可！
<img src="https://silversecond.net/data/p_diary5/20220903A.jpg" border="1" height="400">

ドラッグ＆ドロップするだけで一定範囲の通行設定ができるので
3～4行分のパーツ単位でマップを配っている人にとっても、
CSVと一緒に配布すれば通行設定のデフォルト値が簡単に設定できて安心！
（試しに買ってみたタイル画像集がそういうパーツ配布型でしたが、
当然ながらバラだと通行設定データは作れないのでこれ↑ができると嬉しいかも？）


<strong>- 縦32000ピクセルまでのチップが使用可能に！</strong>
環境によって限界値は変わるかもしれませんが
ツール側としては高さ30000ピクセルのPNGファイルを
読み込んで表示することができました。
画像編集ツールによっては最大が30000ピクセルだったりするみたいなので、
事実上のほぼ無制限とみていい気がします。

なお、なぜ30000pxまでの画像しか作れないのに
推定の限界値が32000だと分かったかというというと、
16サイズのタイルの限界が高さ16000までだったからです。
（内部的に2倍して表示しているため、それで32000を超えられる）

<hr size="1" />
<strong><span style="font-size:large;">【課題！】</span></strong>

<strong>●マップ編集時、1/8モードかつチップ量が画面内に多いとスクロールが重い！</strong>
→　ほとんどの処理は軽くなるのですがスクロールだけが重いです。
この辺りはもっと最適化しないといけなさそうです。</div>

</body>
</html>